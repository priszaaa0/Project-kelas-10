<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Keranjang belanja DolCetta berisi manisan dan kue pilihan Anda." />
  <title>Keranjang Belanja | DolCetta</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800 font-sans">

  <!-- Navbar -->
  <nav class="bg-pink-100 py-4 px-6 flex justify-between items-center shadow">
    <div class="text-2xl font-bold text-pink-500">Dol<span class="text-pink-700">Cetta</span></div>
    <div class="flex items-center gap-4">
      <a href="home.html" class="text-pink-500 hover:underline">Kembali</a>
      <a href="keranjang.html" class="relative" aria-label="Keranjang Belanja">
        <svg class="w-6 h-6 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="9" cy="21" r="1" />
          <circle cx="20" cy="21" r="1" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M1 1h4l2.68 13.39a1 1 0 00.99.81h9.66a1 1 0 00.98-.8l1.38-7.6H6" />
        </svg>
      </a>
    </div>
  </nav>

  <!-- Judul Halaman -->
  <header class="bg-pink-50 py-10 text-center">
    <h1 class="text-3xl font-bold text-pink-600">Keranjang Belanja</h1>
    <p class="text-gray-500 mt-2">Lihat dan kelola manisan favoritmu</p>
  </header>

  <!-- Isi Keranjang -->
  <main class="max-w-4xl mx-auto p-6 bg-white shadow rounded-lg mt-6">
    <div id="cartItems" class="space-y-4 border-b pb-4"></div>

    <!-- Total & Checkout -->
    <div class="flex justify-between items-center mt-6">
      <p class="text-lg font-bold">Total: <span id="total">Rp 0</span></p>
      <a href="checkout.html">
        <button class="transition duration-300 bg-pink-500 text-white px-6 py-2 rounded-lg hover:bg-pink-600">
          Checkout
        </button>
      </a>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-10 py-6 text-center text-sm text-gray-400">
    &copy; 2025 DolCetta. All rights reserved.
  </footer>

  <script>
    const cartContainer = document.getElementById('cartItems');

    function formatRupiah(number) {
      const rate = 15000;
      return new Intl.NumberFormat('id-ID', {
        style: 'currency',
        currency: 'IDR',
        minimumFractionDigits: 0
      }).format(number * rate);
    }

    function updateTotal() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const checkboxes = document.querySelectorAll(".item-checkbox");
      let total = 0;

      checkboxes.forEach((checkbox) => {
        if (checkbox.checked) {
          const index = parseInt(checkbox.dataset.index);
          const item = cart[index];
          const quantity = item.quantity || 1;
          total += (item.price || 0) * quantity;
        }
      });

      document.getElementById("total").textContent = formatRupiah(total);
    }

    function removeItem(index) {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    function changeQuantity(index, delta) {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      if (!cart[index].quantity) cart[index].quantity = 1;

      cart[index].quantity += delta;
      if (cart[index].quantity < 1) cart[index].quantity = 1;

      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    function renderCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      cartContainer.innerHTML = '';

      if (cart.length === 0) {
        cartContainer.innerHTML = `<p class="text-gray-500 text-center">Keranjang kamu masih kosong.</p>`;
        updateTotal();
        return;
      }

      cart.forEach((item, index) => {
        const quantity = item.quantity || 1;
        const name = item.name || 'Produk Tanpa Nama';
        const image = item.image || 'https://via.placeholder.com/100';
        const price = item.price || 0;

        const itemHTML = `
          <div class="flex items-start gap-4">
            <div class="pt-6 pl-2">
              <input type="checkbox" class="item-checkbox w-6 h-6 accent-pink-500" data-index="${index}" checked />
            </div>
            <div class="py-4 px-6 flex justify-between items-center w-full rounded-lg shadow">
              <div class="flex items-center gap-6">
                <img src="${image}" alt="${name}" class="w-[100px] h-[100px] object-contain rounded" />
                <div>
                  <h2 class="text-xl font-bold text-pink-700">${name}</h2>
                  <p class="text-lg font-semibold text-gray-800 mt-1">${formatRupiah(price)}</p>

                  <div class="flex items-center mt-3 border border-pink-500 rounded overflow-hidden w-max">
                    <button onclick="changeQuantity(${index}, -1)" class="px-3 py-1 text-pink-500 hover:bg-pink-100">âˆ’</button>
                    <div id="qty-${index}" class="px-4 py-1 text-pink-600">${quantity}</div>
                    <button onclick="changeQuantity(${index}, 1)" class="px-3 py-1 text-pink-500 hover:bg-pink-100">+</button>
                  </div>
                </div>
              </div>
              <button onclick="removeItem(${index})" class="text-red-500 hover:underline text-sm">Hapus</button>
            </div>
          </div>
        `;

        cartContainer.insertAdjacentHTML('beforeend', itemHTML);
      });

      document.querySelectorAll(".item-checkbox").forEach((checkbox) => {
        checkbox.addEventListener("change", updateTotal);
      });

      updateTotal();
    }

    renderCart();
  </script>

</body>
</html>
